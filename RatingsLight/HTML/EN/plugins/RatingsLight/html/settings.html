[% IF useExtJS; extJsScripts = BLOCK %]
<script TYPE="text/javascript">
function manimport() {
	function sleep(ms) {
  		return new Promise(resolve => setTimeout(resolve, ms));
	}
	let proceed = confirm("[% "PLUGIN_RATINGSLIGHT_MANUAL_IMPORT_WARNING" |string %]");

	if (proceed === true) {
		ajaxRequest('/jsonrpc.js', {
			   id: 1,
			   method: "slim.request",
			   params: [
					   playerid,
					   ["ratingslight","manualimport"],
			   ]
		});
		document.getElementById("importstatus").innerHTML = "Importing...";
		sleep([% prefs.exectime_import %]).then(() => { document.getElementById("importstatus").innerHTML = ""; });
	}
}
function exportplayliststofiles() {
	function sleep(ms) {
  		return new Promise(resolve => setTimeout(resolve, ms));
	}
	let proceed = confirm("[% "PLUGIN_RATINGSLIGHT_EXPORT_PLAYLISTS_TO_FILES_WARNING" |string %]");

	if (proceed === true) {
		ajaxRequest('/jsonrpc.js', {
			   id: 1,
			   method: "slim.request",
			   params: [
					   playerid,
					   ["ratingslight","exportplayliststofiles"],
			   ]
		});
		document.getElementById("exportstatus").innerHTML = "Exporting...";
		sleep([% prefs.exectime_export %]).then(() => { document.getElementById("exportstatus").innerHTML = ""; });
	}
}
</script>
[% END; END %]

[% PROCESS settings/header.html %]
[% WRAPPER setting title="PLUGIN_RATINGSLIGHT" desc="" %]
[% "PLUGIN_RATINGSLIGHT_DESC" | string %][% END %]
<hr><br>

[% WRAPPER setting title="Remote Buttons" desc="" %]
[% WRAPPER setting title="PLUGIN_RATINGSLIGHT_REMOTEBUTTONS" desc="PLUGIN_RATINGSLIGHT_REMOTEBUTTONS_DESC" %]
<select name="pref_enableIRremotebuttons" id="enableIRremotebuttons">
	<option value="1" [% IF prefs.enableIRremotebuttons %]selected[% END %]>[% "Yes" | string %]</option>
	<option value="0" [% IF NOT prefs.enableIRremotebuttons %]selected[% END %]>[% "No" | string %]</option>
</select>
[% END %]
[% END %]
<hr><br>

[% WRAPPER setting title="Menus" desc="" %]
[% WRAPPER setting title="PLUGIN_RATINGSLIGHT_RATINGCONTEXTMENU_DISPLAYMODE" desc="PLUGIN_RATINGSLIGHT_RATINGCONTEXTMENU_DISPLAYMODE_DESC" %]
<select name="pref_ratingcontextmenudisplaymode" id="ratingcontextmenudisplaymode">
		[% FOREACH option = {
			'0' => 'PLUGIN_RATINGSLIGHT_RATINGCONTEXTMENU_DISPLAYMODE_STARS_TEXT',
			'1' => 'PLUGIN_RATINGSLIGHT_RATINGCONTEXTMENU_DISPLAYMODE_STARS',
			'2' => 'PLUGIN_RATINGSLIGHT_RATINGCONTEXTMENU_DISPLAYMODE_TEXT',
		} %]
			<option [% IF prefs.ratingcontextmenudisplaymode == option.key %]selected='selected' [% END %]value="[% option.key %]">[% option.value | string %]</option>
		[%- END -%]
</select>
[% END %]
<br>

[% WRAPPER setting title="PLUGIN_RATINGSLIGHT_RATINGCONTEXTMENU_SETHALFSTARS" desc="PLUGIN_RATINGSLIGHT_RATINGCONTEXTMENU_SETHALFSTARS_DESC" %]
<select name="pref_ratingcontextmenusethalfstars" id="ratingcontextmenusethalfstars">
	<option value="1" [% IF prefs.ratingcontextmenusethalfstars %]selected[% END %]>[% "Yes" | string %]</option>
	<option value="0" [% IF NOT prefs.ratingcontextmenusethalfstars %]selected[% END %]>[% "No" | string %]</option>
</select>
[% END %]
<br>

[% WRAPPER setting title="PLUGIN_RATINGSLIGHT_SHOW_RATED_TRACKS_MENUS" desc="PLUGIN_RATINGSLIGHT_SHOW_RATED_TRACKS_MENUS_DESC" %]
<select name="pref_showratedtracksmenus" id="showratedtracksmenus">
		[% FOREACH option = {
			'0' => 'PLUGIN_RATINGSLIGHT_SHOW_RATED_TRACKS_MENUS_DISABLE',
			'1' => 'PLUGIN_RATINGSLIGHT_SHOW_RATED_TRACKS_MENUS_RATED_ONLY',
			'2' => 'PLUGIN_RATINGSLIGHT_SHOW_RATED_TRACKS_MENUS_HIGH',
		} %]
			<option [% IF prefs.showratedtracksmenus == option.key %]selected='selected' [% END %]value="[% option.key %]">[% option.value | string %]</option>
		[%- END -%]
</select>
[% END %]
<br>

[% WRAPPER setting title="PLUGIN_RATINGSLIGHT_AUTOREBUILD_VLS_AFTER_RATING_CHANGE" desc="PLUGIN_RATINGSLIGHT_AUTOREBUILD_VLS_AFTER_RATING_CHANGE_DESC" %]
<select name="pref_autorebuildvirtualibraryafterrating" id="autorebuildvirtualibraryafterrating">
	<option value="1" [% IF prefs.autorebuildvirtualibraryafterrating %]selected[% END %]>[% "Yes" | string %]</option>
	<option value="0" [% IF NOT prefs.autorebuildvirtualibraryafterrating %]selected[% END %]>[% "No" | string %]</option>
</select>
[% END %]
[% END %]
<hr><br>

[% WRAPPER setting title="Export Ratings" desc="" %]
[% WRAPPER setting title="PLUGIN_RATINGSLIGHT_EXPORT_PLAYLISTS_TO_FILES" desc="PLUGIN_RATINGSLIGHT_EXPORT_PLAYLISTS_TO_FILES_DESC" %]
<div><a href="#" onclick='exportplayliststofiles();'>[% "PLUGIN_RATINGSLIGHT_EXPORT_PLAYLISTS_TO_FILES_LINK" | string %]</a> <span style="color:red;padding-left:15px;font-weight:600;" id="exportstatus"></span></div>
[% END %]
<br>

[% WRAPPER setting title="PLUGIN_RATINGSLIGHT_EXPORT_PLAYLISTS_ONLY_DIFF" desc="PLUGIN_RATINGSLIGHT_EXPORT_PLAYLISTS_ONLY_DIFF_DESC" %]
<select name="pref_onlyratingnotmatchcommenttag" id="onlyratingnotmatchcommenttag">
	<option value="1" [% IF prefs.onlyratingnotmatchcommenttag %]selected[% END %]>[% "Yes" | string %]</option>
	<option value="0" [% IF NOT prefs.onlyratingnotmatchcommenttag %]selected[% END %]>[% "No" | string %]</option>
</select>
[% END %]
[% END %]
<hr><br>

[% WRAPPER setting title="Import Ratings" desc="" %]
[% WRAPPER setting title="PLUGIN_RATINGSLIGHT_RATING_KEYWORD" desc="PLUGIN_RATINGSLIGHT_RATING_KEYWORD_DESC" %]
<br>
<table width="50%">
	<tr>
		<th style="text-align:center;"><b>Rating Keyword <u>Pre</u>fix</b></th>
		<th style="text-align:center;"><b>Rating Keyword <u>Suf</u>fix</b></th>
	</tr>
	<tr>
		<th style="height:4px;" colspan="2"></th>
	</tr>
	<tr>
		<th><input style="text-align:center;" type="text" name="pref_rating_keyword_prefix" id="rating_keyword_prefix" value="[% prefs.rating_keyword_prefix %]" size="40"></th>
		<th><input style="text-align:center;" type="text" name="pref_rating_keyword_suffix" id="rating_keyword_suffix" value="[% prefs.rating_keyword_suffix %]" size="40"></th>
	</tr>
</table>
<br><br>
<b>Example:</b><br><b>pre</b>fix = favstars, <b>suffix</b> = afx: if comment tag contains "favstars<b>4</b>afx" -> rating = <b>4</b> stars
[% END %]
<br>

[% WRAPPER setting title="PLUGIN_RATINGSLIGHT_AUTOSCAN" desc="PLUGIN_RATINGSLIGHT_AUTOSCAN_DESC" %]
<select name="pref_autoscan" id="autoscan">
	<option value="1" [% IF prefs.autoscan %]selected[% END %]>[% "Yes" | string %]</option>
	<option value="0" [% IF NOT prefs.autoscan %]selected[% END %]>[% "No" | string %]</option>
</select>
[% END %]
<br>

[% WRAPPER setting title="PLUGIN_RATINGSLIGHT_MANUAL_IMPORT" desc="" %]
<div><a href="#" onclick='manimport();'>[% "PLUGIN_RATINGSLIGHT_MANUAL_IMPORT_LINK" | string %]</a> <span style="color:red;padding-left:15px;font-weight:600;" id="importstatus"></span></div>
[% END %]
[% END %]
[% PROCESS settings/footer.html %]
